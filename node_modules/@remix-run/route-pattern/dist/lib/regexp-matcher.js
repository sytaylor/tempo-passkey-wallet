import { RoutePattern } from "./route-pattern.js";
/**
 * A simple array-based matcher that compiles route patterns to regular expressions.
 *
 * **Use RegExpMatcher when:**
 * - You have a single or handful of patterns
 * - Build time is critical (cold boot scenarios)
 * - Pattern set changes frequently (cheap to rebuild)
 * - Memory footprint needs to be minimal
 */
export class RegExpMatcher {
    #pairs = [];
    #count = 0;
    add(pattern, data) {
        let routePattern = typeof pattern === 'string' ? new RoutePattern(pattern) : pattern;
        this.#pairs.push({ pattern: routePattern, data });
        this.#count++;
    }
    match(url) {
        if (typeof url === 'string')
            url = new URL(url);
        for (let { pattern, data } of this.#pairs) {
            let match = pattern.match(url);
            if (match) {
                return { data, params: match.params, url: match.url };
            }
        }
        return null;
    }
    *matchAll(url) {
        if (typeof url === 'string')
            url = new URL(url);
        for (let { pattern, data } of this.#pairs) {
            let match = pattern.match(url);
            if (match) {
                yield { data, params: match.params, url: match.url };
            }
        }
    }
    get size() {
        return this.#count;
    }
}
